(function(){var e,i,a,n,t,s,l,o,d,r,c,u,p;d=function(e){var i;return console.log("TEST!"),i=$.ajax({url:"/get/notification/message/names",method:"POST",data:{}}),i.done(function(i){var a,n,t,s,l,o;for(i=JSON.parse(i),console.log(i),$(".dropdown.notification_message > .menu").emtpy,a=0,n=i.length;a<n;a++)t=i[a],o=t.uuid,s=t.name,l="<div class='item' data-value='"+o+"'>"+s+"</div>",console.log(l),$(".dropdown.notification_message > .menu").append(l);return e("finished")})},window.get_notification_messages=d,t=function(e){var i;void 0!==e&&($(e).addClass("disabled"),$(e).addClass("loading")),i=$.ajax({url:"/get/plant/notification/message",method:"POST"}),i.done(function(i){if(i=JSON.parse(i),$(".notification_message_content").val(i.message),$(".ui.selection.dropdown").dropdown("set selected",i.uuid),void 0!==e)return $(e).removeClass("disabled"),$(e).removeClass("loading")})},window.get_current_notification_message=t,o=function(e){var i;return i=$.ajax({url:"/get/notification/message/content",method:"POST",data:{uuid:e}}),i.done(function(e){return e=JSON.parse(e),$(".notification_message_content").val(e)})},window.get_notification_message_content=o,p=function(e,i,a,n,t){var s,l;return null==t&&(t=!0),$(e).addClass("disabled"),$(e).addClass("loading"),s={message:i,name:a},s.responsible=t,n===!0&&(s.uuid=n),l=$.ajax({url:"/submit/notification/message",method:"POST",data:s}),l.done(function(i){return i=JSON.parse(i),"ok"!==i.code&&($(".alert").html=i.code),$(e).removeClass("disabled"),$(e).removeClass("loading")})},window.submit_notification_message=p,l=function(){var e;return e=$.ajax({url:"/get/responsibles",method:"POST"}),e.done(function(e){var i,a,n,t,s,l;for(e=JSON.parse(e),$(".ui.middle.aligned.divided.list").html(""),s=[],i=0,a=e.length;i<a;i++)n=e[i],l='<div class="item"> <div class="right floated content"> <div class="ui small basic icon buttons"> <button class="ui button"> <div class="ui radio checkbox"> <input type="radio" name="wizard" [[checked]] onChange="change_wizard_general_settings_responsible(this, \'[[identifier]]\')"> <label><i class="wizard icon"></i> </label> </div> </button> <button onclick="$(\'.[[identifier]]\').accordion(\'toggle\', 0);" class="ui button"><i class="edit icon"></i> </button> <button class="ui button" onclick="delete_general_settings_responsible(\'[[identifier]]\')"><i class="remove icon"></i> </button> </div> </div><img src="https://source.unsplash.com/category/nature" class="ui avatar image"> <div class="content">[[name]]</div> <div class="ui accordion [[identifier]]"> <div style="height:0;padding:0" class="title"></div> <div style="margin-top:1%" class="content"> <div class="ui grid"> <div class="two column row relaxed"> <div style="margin-bottom:1%" class="column"> <div class="ui fluid left icon input"> <input type="text" class="name-[[identifier]]" placeholder="Name" value="[[name]]"><i class="tag icon"></i> </div> </div> <div class="column"> <div class="ui fluid left icon input"> <input type="text" class="email-[[identifier]]" placeholder="EMail" value="[[email]]"><i class="mail icon"></i> </div> </div> </div> </div> <div class="ui two buttons"> <div class="ui basic button fluid green" onclick="change_information_general_settings_responsible(this, \'[[identifier]]\')">Apply</div> <div class="ui basic button fluid red">Reset</div> </div> </div> </div> <script type="text/javascript"> </script> </div>',l=l.replace(/\[\[identifier\]\]/g,n.uuid),l=l.replace(/\[\[name\]\]/g,n.name),l=l.replace(/\[\[email\]\]/g,n.email),t=n.wizard===!1?"":"checked",l=l.replace(/\[\[checked\]\]/g,t),s.push($(".ui.middle.aligned.divided.list").append(l));return s})},window.get_general_settings_responsibles=l,n=function(e){var i;i=$.ajax({url:"/remove/responsible",method:"POST",data:{uuid:e}}),i.done(function(e){e=JSON.parse(e),console.log(e),l()})},window.delete_general_settings_responsible=n,i=function(e,i){var a;e.checked&&(a=$.ajax({url:"/change/responsible/wizard",method:"POST",data:{uuid:i}}),a.done(function(e){e=JSON.parse(e),console.log(e),l()}))},window.change_wizard_general_settings_responsible=i,e=function(e,i){var a,n,t;$(e).addClass("disabled"),$(e).addClass("loading"),n=$(".name-"+i).val(),a=$(".email-"+i).val(),t=$.ajax({url:"/change/responsible",method:"POST",data:{uuid:i,name:n,email:a}}),t.done(function(i){i=JSON.parse(i),console.log(i),$(e).removeClass("disabled"),$(e).removeClass("loading"),l()})},window.change_information_general_settings_responsible=e,a=function(){var e,i,a;i=$(".new.name").val(),e=$(".new.email").val(),a=$.ajax({url:"/create/responsible/none",method:"POST",data:{name:i,email:e,wizard:"no"}}),a.done(function(e){return e=JSON.parse(e),console.log(e),$(".new.name").val(""),$(".new.email").val(""),l()})},window.create_new_general_settings_responsible=a,u=function(e){var i;$(e).addClass("disabled"),$(e).addClass("loading"),i=$.ajax({url:"/change/plant/intervals",method:"POST",data:{notification:$("#flat-slider-general-interval").slider("option","value"),connection:$("#flat-slider-dead-interval").slider("option","value"),non_persistant:$("#flat-slider-non-persistant-interval").slider("option","value")}}),i.done(function(i){return i=JSON.parse(i),$(e).removeClass("disabled"),$(e).removeClass("loading")})},window.modify_plant_durations=u,s=function(){var e;e=$.ajax({url:"/get/day_night",method:"POST"}),e.done(function(e){var i,a;return e=JSON.parse(e),e.ledbar&&$(".field.ledbar > .ui.checkbox > input").prop("checked",!0),e.display&&$(".field.display > .ui.checkbox > input").prop("checked",!0),e.generalleds&&$(".field.generalleds > .ui.checkbox > input").prop("checked",!0),e.notification&&$(".field.notification > .ui.checkbox > input").prop("checked",!0),i=e.start.toString(),i=3===i.length?i.slice(0,1):i.slice(0,2),a=e.stop.toString(),a=3===a.length?a.slice(0,1):a.slice(0,2),$("#flat-slider-time-interval").slider({max:24,min:0,range:!0,values:[parseInt(i),parseInt(a)]}).slider("pips",{first:"pip",last:"pip"})})},window.get_day_night=s,c=function(e){var i,a;$(e).addClass("disabled"),$(e).addClass("loading"),a=$("#flat-slider-time-interval").slider("option","values"),i=$.ajax({url:"/change/day_night",method:"POST",data:{stop:parseInt(a[1].toString()+"00"),start:parseInt(a[0].toString()+"00"),ledbar:$(".field.ledbar > .ui.checkbox > input").prop("checked"),display:$(".field.display > .ui.checkbox > input").prop("checked"),generalleds:$(".field.generalleds > .ui.checkbox > input").prop("checked"),notification:$(".field.notification > .ui.checkbox > input").prop("checked")}}),i.done(function(i){return i=JSON.parse(i),$(e).removeClass("disabled"),$(e).removeClass("loading")})},window.modify_day_night=c,r=function(){var e;e=$.ajax({url:"/get/manage",method:"POST"}),e.done(function(e){var i,a,n,t,s,l,o,d,r,c,u,p,v,g,m;for(e=JSON.parse(e),a="",l="<div class='item'> <div class='ui equal width grid'> <div class='column'> <a class='ui [[COLOR]] ribbon label' [[ADDITIONAL]]>[[MASTER]]</a> <span style='font-weight:bold'>[[NAME]]</span> </div> [[SLAVE]] <div class='column right aligned'> <div class='ui icon buttons'> <button class='ui button'> <i class='edit icon' /> </button> <button class='ui button'> <i class='checkmark icon' /> </button> <button class='ui button'> <i class='erase icon' /> </button> </div> </div> </div> </div>",v="<div class='column'> My master is <div class='ui inline dropdown [[NAME]] slave'> <div class='text'>[[HOST]]</div> <i class='dropdown icon' /> <div class='menu'> [[MASTERS]] </div> </div> </div>",d={},g={},n=0,s=e.length;n<s;n++)r=e[n],"master"===r.role?d[r.uuid]=r:g[r.uuid]=r;for(t in d)r=d[t],a+=l.replace("[[MASTER]]","Master").replace("[[NAME]]",_.capitalize(r.name)).replace("[[SLAVE]]","").replace("[[COLOR]]","red").replace("[[ADDITIONAL]]","");for(t in g){r=g[t],i=l.replace("[[MASTER]]","Slave").replace(/\[\[NAME\]\]/,r.name).replace("[[COLOR]]","orange").replace("[[ADDITIONAL]]",m="style='padding-right:2em'"),u=v.replace("[[NAME]]",_.capitalize(r.name)).replace("[[HOST]]",d[r.role].name),c="";for(t in d)o=d[t],c+="<div class='item' data-value='"+o.uuid+"'>"+_.capitalize(o.name)+"</div>";u=u.replace("[[MASTERS]]",c),a+=i.replace("[[SLAVE]]",u)}$(".ui.relaxed.divided.list").html(a),p=[];for(t in g)r=g[t],p.push($("."+r.name+".slave").dropdown({}));return p})},window.init_manage=r}).call(this);